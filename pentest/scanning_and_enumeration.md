# Scanning and enumeration

- [LAN](#lan)
- [NMAP](#nmap)
- [Nikto](#nikto)
- [HTTP directory enumeration](#http-directory-enumeration)
- [SAMBA](#samba)
- [SSH](#ssh)
- [Masscan](#masscan)
- [scanning with metasploit](#scanning-with-metasploit)
- [NFS](#nfs)
- [Skipfish](#skipfish)

## LAN

Very basic Kali tools:

```
arp-scan -l
netdiscover -r 192.168.0.0/24
```

## NMAP

Simple host/port discovery (TCP)

```
nmap -iL host_list.txt -T4 -Pn -n -p- -oA scan_output
```

Simple host/port discovery (UDP)

```
nmap -T4 -Pn -n -sU -p- -oA scan_output 192.168.88.242
```

Some tips:

```
-ddd (for intense debug)
--max-retries 0 (if you are pretty confident on your network
```

Default scripts:

```
# grep categories /usr/share/nmap/scripts/*.nse |grep default | awk -F: '{ print $1 }' | sed -e 's/\/usr\/share\/nmap\/scripts\///g'
address-info.nse
afp-serverinfo.nse
ajp-auth.nse
ajp-methods.nse
amqp-info.nse
auth-owners.nse
backorifice-info.nse
bitcoinrpc-info.nse
cassandra-info.nse
clock-skew.nse
creds-summary.nse
dicom-ping.nse
dns-nsid.nse
dns-recursion.nse
dns-service-discovery.nse
epmd-info.nse
finger.nse
flume-master-info.nse
freelancer-info.nse
ftp-anon.nse
ftp-bounce.nse
ftp-syst.nse
ganglia-info.nse
giop-info.nse
gopher-ls.nse
hadoop-datanode-info.nse
hadoop-jobtracker-info.nse
hadoop-namenode-info.nse
hadoop-secondary-namenode-info.nse
hadoop-tasktracker-info.nse
hbase-master-info.nse
hbase-region-info.nse
hddtemp-info.nse
http-auth.nse
http-cisco-anyconnect.nse
http-cookie-flags.nse
http-cors.nse
http-default-accounts.nse
http-default-accounts.nse
http-default-accounts.nse
http-favicon.nse
http-generator.nse
http-git.nse
http-ls.nse
http-methods.nse
http-ntlm-info.nse
http-open-proxy.nse
http-robots.txt.nse
http-svn-enum.nse
http-svn-info.nse
http-title.nse
ike-version.nse
imap-capabilities.nse
imap-ntlm-info.nse
ip-https-discover.nse
ipv6-node-info.nse
irc-info.nse
iscsi-info.nse
jdwp-info.nse
knx-gateway-info.nse
maxdb-info.nse
mongodb-databases.nse
mongodb-info.nse
ms-sql-info.nse
ms-sql-ntlm-info.nse
mysql-info.nse
nat-pmp-info.nse
nbstat.nse
ncp-serverinfo.nse
netbus-info.nse
nntp-ntlm-info.nse
ntp-info.nse
openlookup-info.nse
p2p-conficker.nse
pop3-capabilities.nse
pop3-ntlm-info.nse
quake1-info.nse
quake3-info.nse
quake3-master-getservers.nse
rdp-ntlm-info.nse
rmi-dumpregistry.nse
rpcinfo.nse
rtsp-methods.nse
servicetags.nse
sip-methods.nse
smb2-security-mode.nse
smb2-time.nse
smb-os-discovery.nse
smb-security-mode.nse
smtp-commands.nse
smtp-ntlm-info.nse
snmp-hh3c-logins.nse
snmp-info.nse
snmp-interfaces.nse
snmp-netstat.nse
snmp-processes.nse
snmp-sysdescr.nse
snmp-win32-services.nse
snmp-win32-shares.nse
snmp-win32-software.nse
snmp-win32-users.nse
socks-auth-info.nse
socks-open-proxy.nse
ssh-hostkey.nse
sshv1.nse
ssl-cert.nse
ssl-date.nse
ssl-known-key.nse
sslv2.nse
sstp-discover.nse
telnet-ntlm-info.nse
tls-alpn.nse
tls-nextprotoneg.nse
ubiquiti-discovery.nse
upnp-info.nse
uptime-agent-info.nse
ventrilo-info.nse
vnc-info.nse
wdb-version.nse
weblogic-t3-info.nse
wsdd-discover.nse
x11-access.nse
xmlrpc-methods.nse
xmpp-info.nse
```

To only select "safe" scripts:

```
nmap -Pn -p445 10.10.10.40 --script "safe"
```

Or:

```
nmap -Pn -p445 10.10.10.40 --script "safe and vuln"
```

## Nikto

```
nikto -h http://10.31.14.5
```

To skip directory busting:

```
nikto -h hostname -ssl -Plugin "@@DEFAULT;-dir_traversal" -Display V
```

To search for obsolete version:

```
nikto -h hostname -ssl -Plugin outdated -Display V
```

HTML output:

```
nikto -h hostname -o report.htm -Display V
```

## HTTP directory enumeration

### dirbuster

### dirb

### gobuster

### dirsearch

