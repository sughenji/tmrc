# Search vulnerabilities

- [Web resources](#web-resoureces)
- [searchsploit](#searchsploit)
- [Nessus](#nessus)
- [NMAP](#nmap)
- [metasploit](#metasploit)
- [AutoBlue](#autoblue)
- [SMB signing disabled](#smb-signing-disabled)

## Web resources

https://www.cvedetails.com

## searchsploit

```
root@kali:~# searchsploit Samba 2
--------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                                                     |  Path
                                                                                                                                                   | (/usr/share/exploitdb/)
--------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
Microsoft Windows XP/2003 - Samba Share Resource Exhaustion (Denial of Service)                                                                    | exploits/windows/dos/148.sh
Samba 1.9.19 - 'Password' Remote Buffer Overflow                                                                                                   | exploits/linux/remote/20308.c
Samba 2.0.7 - SWAT Logfile Permissions                                                                                                             | exploits/linux/local/20341.sh
Samba 2.0.7 - SWAT Logging Failure                                                                                                                 | exploits/unix/remote/20340.c
Samba 2.0.7 - SWAT Symlink (1)                                                                                                                     | exploits/linux/local/20338.c
Samba 2.0.7 - SWAT Symlink (2)                                                                                                                     | exploits/linux/local/20339.sh
....
root@kali:~# searchsploit mod ssl 2
--------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                                                     |  Path
                                                                                                                                                   | (/usr/share/exploitdb/)
--------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
Apache mod_ssl 2.0.x - Remote Denial of Service                                                                                                    | exploits/linux/dos/24590.txt
Apache mod_ssl 2.8.x - Off-by-One HTAccess Buffer Overflow                                                                                         | exploits/multiple/dos/21575.txt
```

## Nessus

to run a basic scan:

- My Scans -> New Scan
- select "Basic Network Scan"
- choose name and targets
- notification -> insert your email
- Discovery -> Scan Type -> all ports
- Assessment -> select "Scan for know web vulnerabilities"

Launch!

## nmap

```
nmap --script vuln host
nmap --script exploit host
```

## metasploit

```
msf5 > search apache 2.4

Matching Modules
================

   #    Name                                                        Disclosure Date  Rank       Check  Description
   -    ----                                                        ---------------  ----       -----  -----------
   0    auxiliary/admin/appletv/appletv_display_video                                normal     No     Apple TV Video Remote Control
   1    auxiliary/admin/http/mantisbt_password_reset                2017-04-16       normal     Yes    MantisBT password reset
   2    auxiliary/admin/http/tomcat_administration                                   normal     No     Tomcat Administration Tool Default Access
```

Or, using native metasploit scanners:

```
msf5 > use auxiliary/scanner/smb/smb_ms17_010
msf5 auxiliary(scanner/smb/smb_ms17_010) > options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting                                                 Required  Description
   ----         ---------------                                                 --------  -----------
   CHECK_ARCH   true                                                            no        Check for architecture on vulnerable hosts
   CHECK_DOPU   true                                                            no        Check for DOUBLEPULSAR on vulnerable hosts
   CHECK_PIPE   false                                                           no        Check for named pipe on vulnerable hosts
   NAMED_PIPES  /usr/share/metasploit-framework/data/wordlists/named_pipes.txt  yes       List of named pipes to check
   RHOSTS                                                                       yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT        445                                                             yes       The SMB service port (TCP)
   SMBDomain    .                                                               no        The Windows domain to use for authentication
   SMBPass                                                                      no        The password for the specified username
   SMBUser                                                                      no        The username to authenticate as
   THREADS      1                                                               yes       The number of concurrent threads (max one per host)

msf5 auxiliary(scanner/smb/smb_ms17_010) > set RHOSTS 10.10.10.40
RHOSTS => 10.10.10.40
msf5 auxiliary(scanner/smb/smb_ms17_010) > run

[+] 10.10.10.40:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.10.10.40:445       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

## AutoBlue

```
root@kali:/opt/tools/AutoBlue-MS17-010# python eternal_checker.py 10.10.10.40
[*] Target OS: Windows 7 Professional 7601 Service Pack 1
[!] The target is not patched
=== Testing named pipes ===
[*] Done
```

## SMB signing disabled

```
# nmap --script=smb2-security-mode -p445 192.168.1.0/24 --open
```

Look for "Message signing enabled but not required" or "message signing disabled"

