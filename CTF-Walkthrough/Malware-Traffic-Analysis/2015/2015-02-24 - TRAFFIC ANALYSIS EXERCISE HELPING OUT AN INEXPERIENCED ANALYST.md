https://www.malware-traffic-analysis.net/2015/02/24/index.html

by using `nbns` filter on wiresharp, we spot just one workstation:


| ip address    | hostname     | mac address       |
| ------------- | ------------ | ----------------- |
| 10.10.100.139 | STEPHANIE-PC | 28:92:4a:3b:5f:cd |

As suggested, it would be nice to *replay* PCAP's traffic to Security Onion tool (https://docs.securityonion.net/en/2.4/about.html).

Too "big", I'll choose Zeek for now.

https://github.com/zeek/zeek/wiki/Binary-Packages

```bash
root@zeek:/opt/zeek/bin# ./zeekctl
Hint: Run the zeekctl "deploy" command to get started.

Welcome to ZeekControl 2.5.0-49

Type "help" for help.

[ZeekControl] >
```

https://www.amirootyet.com/post/pcap-analysis-zeek/

```bash
root@zeek:/home/sugo# zeek -r 2015-02-24-traffic-analysis-exercise.pcap
root@zeek:/home/sugo# ls -l
total 7604
-rw-r--r-- 1 sugo sugo 7340912 Jan  2 17:23 2015-02-24-traffic-analysis-exercise.pcap
-rw-r--r-- 1 root root   63519 Jan  3 11:48 conn.log
-rw-r--r-- 1 root root     534 Jan  3 11:48 dhcp.log
-rw-r--r-- 1 root root   94718 Jan  3 11:48 dns.log
-rw-r--r-- 1 root root   44291 Jan  3 11:48 files.log
-rw-r--r-- 1 root root  194529 Jan  3 11:48 http.log
-rw-r--r-- 1 root root     820 Jan  3 11:48 ntp.log
-rw-r--r-- 1 root root     278 Jan  3 11:48 packet_filter.log
-rw-r--r-- 1 root root    9174 Jan  3 11:48 ssl.log
-rw-r--r-- 1 root root   11837 Jan  3 11:48 x509.log
```

in `files.log` we noticed some suspicious files:

`application/pdf frdsxlzc96.pdf`

`application/zip mrcgzxf81.xap`

`application/xml IZpHm6dg.jnlp`

`application/java-archive fbigwamn05.jar`

All these files came from `69.64.49.212` (mpzfprxfdn.serveftp.com)

```bash
root@zeek:/home/sugo# grep "69.64.49.212" files.log  | awk '{ print $6,$7,$8,$11,$12 }'
69.64.49.212 80 HTTP text/html -
69.64.49.212 80 HTTP application/x-shockwave-flash sigauyhf817.swf
69.64.49.212 80 HTTP application/pdf frdsxlzc96.pdf
69.64.49.212 80 HTTP application/zip mrcgzxf81.xap
69.64.49.212 80 HTTP - -
69.64.49.212 80 HTTP text/html -
69.64.49.212 80 HTTP - -
69.64.49.212 80 HTTP - -
69.64.49.212 80 HTTP - -
69.64.49.212 80 HTTP application/xml IZpHm6dg.jnlp
69.64.49.212 80 HTTP application/java-archive fbigwamn05.jar
69.64.49.212 80 HTTP - -
```

We also notice traffic to unusual tcp port (`7152`)

![](../../../_attachment/Pasted%20image%2020250103121511.png)

we can also easily extract file with Network Miner tool (on Windows)

![](../../../_attachment/Pasted%20image%2020250103170636.png)
# stream 14

we notice this redirect:

```html
<noscript><META http-equiv="refresh" content="0;URL='http://legacylifespaces.com/'"></noscript>
```

# stream 30

download of file `frdsxlzc96.pdf`

```html
GET /j_86zfsy/2ffd43c90b59cb685e0f045f0208520907515f5f0051530207520306520b010c;910 HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)
Host: mpzfprxfdn.serveftp.com
Connection: Keep-Alive
Cache-Control: no-cache

  

HTTP/1.1 200 OK
Date: Tue, 24 Feb 2015 04:06:22 GMT
Server: Apache/2.2.22 (Debian)
X-Powered-By: PHP/5.3.27
Content-Disposition: inline; filename=frdsxlzc96.pdf
Content-Length: 8145
Content-Type: application/pdf
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
```

let's check md5sum of PDF file

```powershell
PS D:\tmrc\tools\NetworkMiner_2-8\AssembledFiles\69.64.49.212\TCP-80\j_86zfsy> Get-FileHash .\frdsxlzc96.pdf -Algorithm MD5

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
MD5             521EDD04A9E4A1C63972C2D2792B86BC                                       D:\tmrc\tools\NetworkMiner_2-8\AssembledFiles\69.64.49.212\TCP-80\j_86zfsy\frdsxlzc96.pdf
```

https://www.virustotal.com/gui/file/a927b3f2244e901e23e50f6b7a4929b837f0f0d1d8e0dc0a1957f5208b4e4e51

![](../../../_attachment/Pasted%20image%2020250103170735.png)

# stream 31

download of `mrcgzxf81.xap` file

![](../../../_attachment/Pasted%20image%2020250103164153.png)

`PK` implies Zip format (https://en.wikipedia.org/wiki/List_of_file_signatures)

we do the same check for this file:

md5:

```powershell
PS D:\tmrc\tools\NetworkMiner_2-8\AssembledFiles\69.64.49.212\TCP-80\j_86zfsy> Get-FileHash .\mrcgzxf81.xap.silverlight-app -Algorithm md5

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
MD5             838AA83DAE6637E7FEBA340C8D95AD17                                       D:\tmrc\tools\NetworkMiner_2-8\AssembledFiles\69.64.49.212\TCP-80\j_86zfsy\mrcgzxf81.xap.silverlight-app
```

virustotal:

https://www.virustotal.com/gui/file/e905fd29d51671e8de3e198822a2696a384af65c2af592f7f84a7f5c6cfdfa47


![](../../../_attachment/Pasted%20image%2020250103170958.png)

this is were I stopped on my own :)

official solution:

https://www.malware-traffic-analysis.net/2015/02/24/page2.html

