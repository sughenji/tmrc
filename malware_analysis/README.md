# Malware Analysis

- [Tools](#tools)
- [Online resources](#online-resources)
- [General infos](#general-infos)
- [Truestory Analysis](#truestory-analysis)
- [Virustotal](#virustotal)

## tools

regshot https://sourceforge.net/projects/regshot/

Sysinternals: Process Monitor and Process Explorer

Fake DNS: https://www.fireeye.com/services/freeware/apatedns.html

Sandbox: https://cuckoosandbox.org/

## online resources

https://any.run/

https://www.hybrid-analysis.com/

https://abuse.ch/ and his sub-domains:

## https://bazaar.abuse.ch/

you can upload a sample or research (eg. `md5:367b6a5c0e0e8ec68ea14a085b1d32b3`)

## https://threatfox.abuse.ch

eg. search for `ioc:212.192.246.30:5555`

## https://sslbl.abuse.ch/

## https://urlhaus.abuse.ch

## https://feodotracker.abuse.ch

https://feodotracker.abuse.ch/browse.php?search=178.134.47.166

## General infos

https://any.run/malware-trends/


## Truestory analysis

https://www.microsoft.com/security/blog/2019/07/08/dismantling-a-fileless-campaign-microsoft-defender-atp-next-gen-protection-exposes-astaroth-attack/

## Virustotal

```
joshua@kaligra:~$ msf-virustotal -k 94410b2bd266b6e3d2e859aa278efea7b3684181XXXXXXXXXXXXXXXXXXXXXX -f Documents/malware-traffic-analysis/knr.exe
[*] Using API key: 94410b2bd266b6e3d2e859aa278efea7b3684181XXXXXXXXXXXXXXXXXXXXXXXX
[*] Please wait while I upload Documents/malware-traffic-analysis/knr.exe...
[*] VirusTotal: Scan request successfully queued, come back later for the report
[*] Sample MD5 hash    : cc28e40b46237ab6d5282199ef78c464
[*] Sample SHA1 hash   : 0d5c820002cf93384016bd4a2628dcc5101211f4
[*] Sample SHA256 hash : 749e161661290e8a2d190b1a66469744127bc25bf46e5d0c6f2e835f4b92db18
[*] Analysis link: https://www.virustotal.com/gui/file/749e161661290e8a2d190b1a66469744127bc25bf46e5d0c6f2e835f4b92db18/detection/f-749e161661290e8a2d190b1a66469744127bc25bf46e5d0c6f2e835f4b92db18-1662214988
[*] Requesting the report...
[*] Analysis Report: knr.exe (47 / 71): 749e161661290e8a2d190b1a66469744127bc25bf46e5d0c6f2e835f4b92db18
====================================================================================================

 Antivirus             Detected  Version               Result                                              Update
 ---------             --------  -------               ------                                              ------
 ALYac                 true      1.1.3.1               Backdoor.RAT.Netwire                                20220824
 APEX                  true      6.326                 Malicious                                           20220822
 AVG                   true      21.1.5827.0           Win32:Malware-gen                                   20220824
 Acronis               false     1.2.0.108                                                                 20220426
 Ad-Aware              true      3.0.21.193            Trojan.GenericKD.32089895                           20220824
..
..
..
..
```



